/*! For license information please see contentScripts.js.LICENSE.txt */
(()=>{"use strict";var t={d:(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};t.d({},{z:()=>$t});const e={context:void 0,registry:void 0,effects:void 0,done:!1,getContextId(){return n(this.context.count)},getNextContextId(){return n(this.context.count++)}};function n(t){const n=String(t),r=n.length-1;return e.context.id+(r?String.fromCharCode(96+r):"")+n}function r(t){e.context=t}const o=(t,e)=>t===e,i=(Symbol("solid-proxy"),Symbol("solid-track"),Symbol("solid-dev-component"),{equals:o});let a=null,c=G;const u=1,s=2,l={owned:null,cleanups:null,context:null,owner:null};var f=null;let h=null,p=null,d=null,y=null,v=null,g=null,m=0;function w(t,e){const n=y,r=f,o=0===t.length,i=void 0===e?r:e,a=o?l:{owned:null,cleanups:null,context:i?i.context:null,owner:i},c=o?t:()=>t((()=>S((()=>$(a)))));f=a,y=null;try{return I(c,!0)}finally{y=n,f=r}}function b(t,e){const n={value:t,observers:null,observerSlots:null,comparator:(e=e?Object.assign({},i,e):i).equals||void 0};return[j.bind(n),t=>("function"==typeof t&&(t=h&&h.running&&h.sources.has(n)?t(n.tValue):t(n.value)),N(n,t))]}function x(t,e,n){const r=T(t,e,!1,u);p&&h&&h.running?v.push(r):A(r)}function S(t){if(!d&&null===y)return t();const e=y;y=null;try{return d?d.untrack(t):t()}finally{y=e}}function _(t){return null===f||(null===f.cleanups?f.cleanups=[t]:f.cleanups.push(t)),t}function L(t){if(h&&h.running)return t(),h.done;const e=y,n=f;return Promise.resolve().then((()=>{let r;return y=e,f=n,(p||O)&&(r=h||(h={sources:new Set,effects:[],promises:new Set,disposed:new Set,queue:new Set,running:!0}),r.done||(r.done=new Promise((t=>r.resolve=t))),r.running=!0),I(t,!1),y=f=null,r?r.done:void 0}))}const[E,k]=b(!1);let O;function j(){const t=h&&h.running;if(this.sources&&(t?this.tState:this.state))if((t?this.tState:this.state)===u)A(this);else{const t=v;v=null,I((()=>F(this)),!1),v=t}if(y){const t=this.observers?this.observers.length:0;y.sources?(y.sources.push(this),y.sourceSlots.push(t)):(y.sources=[this],y.sourceSlots=[t]),this.observers?(this.observers.push(y),this.observerSlots.push(y.sources.length-1)):(this.observers=[y],this.observerSlots=[y.sources.length-1])}return t&&h.sources.has(this)?this.tValue:this.value}function N(t,e,n){let r=h&&h.running&&h.sources.has(t)?t.tValue:t.value;if(!t.comparator||!t.comparator(r,e)){if(h){const r=h.running;(r||!n&&h.sources.has(t))&&(h.sources.add(t),t.tValue=e),r||(t.value=e)}else t.value=e;t.observers&&t.observers.length&&I((()=>{for(let e=0;e<t.observers.length;e+=1){const n=t.observers[e],r=h&&h.running;r&&h.disposed.has(n)||((r?n.tState:n.state)||(n.pure?v.push(n):g.push(n),n.observers&&B(n)),r?n.tState=u:n.state=u)}if(v.length>1e6)throw v=[],new Error}),!1)}return e}function A(t){if(!t.fn)return;$(t);const e=m;C(t,h&&h.running&&h.sources.has(t)?t.tValue:t.value,e),h&&!h.running&&h.sources.has(t)&&queueMicrotask((()=>{I((()=>{h&&(h.running=!0),y=f=t,C(t,t.tValue,e),y=f=null}),!1)}))}function C(t,e,n){let r;const o=f,i=y;y=f=t;try{r=t.fn(e)}catch(e){return t.pure&&(h&&h.running?(t.tState=u,t.tOwned&&t.tOwned.forEach($),t.tOwned=void 0):(t.state=u,t.owned&&t.owned.forEach($),t.owned=null)),t.updatedAt=n+1,D(e)}finally{y=i,f=o}(!t.updatedAt||t.updatedAt<=n)&&(null!=t.updatedAt&&"observers"in t?N(t,r,!0):h&&h.running&&t.pure?(h.sources.add(t),t.tValue=r):t.value=r,t.updatedAt=n)}function T(t,e,n,r=u,o){const i={fn:t,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:f,context:f?f.context:null,pure:n};if(h&&h.running&&(i.state=0,i.tState=r),null===f||f!==l&&(h&&h.running&&f.pure?f.tOwned?f.tOwned.push(i):f.tOwned=[i]:f.owned?f.owned.push(i):f.owned=[i]),d&&i.fn){const[t,e]=b(void 0,{equals:!1}),n=d.factory(i.fn,e);_((()=>n.dispose()));const r=()=>L(e).then((()=>o.dispose())),o=d.factory(i.fn,r);i.fn=e=>(t(),h&&h.running?o.track(e):n.track(e))}return i}function P(t){const e=h&&h.running;if(0===(e?t.tState:t.state))return;if((e?t.tState:t.state)===s)return F(t);if(t.suspense&&S(t.suspense.inFallback))return t.suspense.effects.push(t);const n=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<m);){if(e&&h.disposed.has(t))return;(e?t.tState:t.state)&&n.push(t)}for(let r=n.length-1;r>=0;r--){if(t=n[r],e){let e=t,o=n[r+1];for(;(e=e.owner)&&e!==o;)if(h.disposed.has(e))return}if((e?t.tState:t.state)===u)A(t);else if((e?t.tState:t.state)===s){const e=v;v=null,I((()=>F(t,n[0])),!1),v=e}}}function I(t,e){if(v)return t();let n=!1;e||(v=[]),g?n=!0:g=[],m++;try{const e=t();return function(t){v&&(p&&h&&h.running?function(t){for(let e=0;e<t.length;e++){const n=t[e],r=h.queue;r.has(n)||(r.add(n),p((()=>{r.delete(n),I((()=>{h.running=!0,P(n)}),!1),h&&(h.running=!1)})))}}(v):G(v),v=null);if(t)return;let e;if(h)if(h.promises.size||h.queue.size){if(h.running)return h.running=!1,h.effects.push.apply(h.effects,g),g=null,void k(!0)}else{const t=h.sources,n=h.disposed;g.push.apply(g,h.effects),e=h.resolve;for(const t of g)"tState"in t&&(t.state=t.tState),delete t.tState;h=null,I((()=>{for(const t of n)$(t);for(const e of t){if(e.value=e.tValue,e.owned)for(let t=0,n=e.owned.length;t<n;t++)$(e.owned[t]);e.tOwned&&(e.owned=e.tOwned),delete e.tValue,delete e.tOwned,e.tState=0}k(!1)}),!1)}const n=g;g=null,n.length&&I((()=>c(n)),!1);e&&e()}(n),e}catch(t){n||(g=null),v=null,D(t)}}function G(t){for(let e=0;e<t.length;e++)P(t[e])}function F(t,e){const n=h&&h.running;n?t.tState=0:t.state=0;for(let r=0;r<t.sources.length;r+=1){const o=t.sources[r];if(o.sources){const t=n?o.tState:o.state;t===u?o!==e&&(!o.updatedAt||o.updatedAt<m)&&P(o):t===s&&F(o,e)}}}function B(t){const e=h&&h.running;for(let n=0;n<t.observers.length;n+=1){const r=t.observers[n];(e?r.tState:r.state)||(e?r.tState=s:r.state=s,r.pure?v.push(r):g.push(r),r.observers&&B(r))}}function $(t){let e;if(t.sources)for(;t.sources.length;){const e=t.sources.pop(),n=t.sourceSlots.pop(),r=e.observers;if(r&&r.length){const t=r.pop(),o=e.observerSlots.pop();n<r.length&&(t.sourceSlots[o]=n,r[n]=t,e.observerSlots[n]=o)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)$(t.tOwned[e]);delete t.tOwned}if(h&&h.running&&t.pure)M(t,!0);else if(t.owned){for(e=t.owned.length-1;e>=0;e--)$(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}h&&h.running?t.tState=0:t.state=0}function M(t,e){if(e||(t.tState=0,h.disposed.add(t)),t.owned)for(let e=0;e<t.owned.length;e++)M(t.owned[e])}function V(t){return t instanceof Error?t:new Error("string"==typeof t?t:"Unknown error",{cause:t})}function q(t,e,n){try{for(const n of e)n(t)}catch(t){D(t,n&&n.owner||null)}}function D(t,e=f){const n=a&&e&&e.context&&e.context[a],r=V(t);if(!n)throw r;g?g.push({fn(){q(r,n,e)},state:u}):q(r,n,e)}Symbol("fallback");let H=!1;function U(t,n){if(H&&e.context){const o=e.context;r({...e.context,id:e.getNextContextId(),count:0});const i=S((()=>t(n||{})));return r(o),i}return S((()=>t(n||{})))}Object.create(null),Object.create(null);function Y(t,e,n,r={}){let o;return w((r=>{o=r,e===document?t():K(e,t(),e.firstChild?null:void 0,n)}),r.owner),()=>{o(),e.textContent=""}}function R(t,e,n){let r;const o=()=>{const e=document.createElement("template");return e.innerHTML=t,n?e.content.firstChild.firstChild:e.content.firstChild},i=e?()=>S((()=>document.importNode(r||(r=o()),!0))):()=>(r||(r=o())).cloneNode(!0);return i.cloneNode=i,i}function z(t,e,n){Q(t)||(null==n?t.removeAttribute(e):t.setAttribute(e,n))}function J(t,e,n,r){if(r)Array.isArray(n)?(t[`$$${e}`]=n[0],t[`$$${e}Data`]=n[1]):t[`$$${e}`]=n;else if(Array.isArray(n)){const r=n[0];t.addEventListener(e,n[0]=e=>r.call(t,n[1],e))}else t.addEventListener(e,n,"function"!=typeof n&&n)}function K(t,e,n,r){if(void 0===n||r||(r=[]),"function"!=typeof e)return W(t,e,r,n);x((r=>W(t,e(),r,n)),r)}function Q(t){return!!e.context&&!e.done&&(!t||t.isConnected)}function W(t,e,n,r,o){const i=Q(t);if(i){!n&&(n=[...t.childNodes]);let e=[];for(let t=0;t<n.length;t++){const r=n[t];8===r.nodeType&&"!$"===r.data.slice(0,2)?r.remove():e.push(r)}n=e}for(;"function"==typeof n;)n=n();if(e===n)return n;const a=typeof e,c=void 0!==r;if(t=c&&n[0]&&n[0].parentNode||t,"string"===a||"number"===a){if(i)return n;if("number"===a&&(e=e.toString())===n)return n;if(c){let o=n[0];o&&3===o.nodeType?o.data!==e&&(o.data=e):o=document.createTextNode(e),n=tt(t,n,r,o)}else n=""!==n&&"string"==typeof n?t.firstChild.data=e:t.textContent=e}else if(null==e||"boolean"===a){if(i)return n;n=tt(t,n,r)}else{if("function"===a)return x((()=>{let o=e();for(;"function"==typeof o;)o=o();n=W(t,o,n,r)})),()=>n;if(Array.isArray(e)){const a=[],u=n&&Array.isArray(n);if(X(a,e,n,o))return x((()=>n=W(t,a,n,r,!0))),()=>n;if(i){if(!a.length)return n;if(void 0===r)return n=[...t.childNodes];let e=a[0];if(e.parentNode!==t)return n;const o=[e];for(;(e=e.nextSibling)!==r;)o.push(e);return n=o}if(0===a.length){if(n=tt(t,n,r),c)return n}else u?0===n.length?Z(t,a,r):function(t,e,n){let r=n.length,o=e.length,i=r,a=0,c=0,u=e[o-1].nextSibling,s=null;for(;a<o||c<i;)if(e[a]!==n[c]){for(;e[o-1]===n[i-1];)o--,i--;if(o===a){const e=i<r?c?n[c-1].nextSibling:n[i-c]:u;for(;c<i;)t.insertBefore(n[c++],e)}else if(i===c)for(;a<o;)s&&s.has(e[a])||e[a].remove(),a++;else if(e[a]===n[i-1]&&n[c]===e[o-1]){const r=e[--o].nextSibling;t.insertBefore(n[c++],e[a++].nextSibling),t.insertBefore(n[--i],r),e[o]=n[i]}else{if(!s){s=new Map;let t=c;for(;t<i;)s.set(n[t],t++)}const r=s.get(e[a]);if(null!=r)if(c<r&&r<i){let u,l=a,f=1;for(;++l<o&&l<i&&null!=(u=s.get(e[l]))&&u===r+f;)f++;if(f>r-c){const o=e[a];for(;c<r;)t.insertBefore(n[c++],o)}else t.replaceChild(n[c++],e[a++])}else a++;else e[a++].remove()}}else a++,c++}(t,n,a):(n&&tt(t),Z(t,a));n=a}else if(e.nodeType){if(i&&e.parentNode)return n=c?[e]:e;if(Array.isArray(n)){if(c)return n=tt(t,n,r,e);tt(t,n,null,e)}else null!=n&&""!==n&&t.firstChild?t.replaceChild(e,t.firstChild):t.appendChild(e);n=e}}return n}function X(t,e,n,r){let o=!1;for(let i=0,a=e.length;i<a;i++){let a,c=e[i],u=n&&n[t.length];if(null==c||!0===c||!1===c);else if("object"==(a=typeof c)&&c.nodeType)t.push(c);else if(Array.isArray(c))o=X(t,c,u)||o;else if("function"===a)if(r){for(;"function"==typeof c;)c=c();o=X(t,Array.isArray(c)?c:[c],Array.isArray(u)?u:[u])||o}else t.push(c),o=!0;else{const e=String(c);u&&3===u.nodeType&&u.data===e?t.push(u):t.push(document.createTextNode(e))}}return o}function Z(t,e,n=null){for(let r=0,o=e.length;r<o;r++)t.insertBefore(e[r],n)}function tt(t,e,n,r){if(void 0===n)return t.textContent="";const o=r||document.createTextNode("");if(e.length){let r=!1;for(let i=e.length-1;i>=0;i--){const a=e[i];if(o!==a){const e=a.parentNode===t;r||i?e&&a.remove():e?t.replaceChild(o,a):t.insertBefore(o,n)}else r=!0}}else t.insertBefore(o,n);return[o]}Symbol();function et(t){return et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},et(t)}var nt=R("<div><a>"),rt=R("<div>"),ot=R("<button type=button>レート対象曲を表示"),it=R("<div class=sparebeat_extensions_rate_view><div><h3>レート対象曲</h3><div class=sparebeat_extensions_rate_list></div><h3>レート候補曲</h3><div class=sparebeat_extensions_rate_list>"),at=R("<div class=sparebeat_extensions_rate>rate:");function ct(){ct=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),c=new A(r||[]);return o(a,"_invoke",{value:k(t,n,c)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",v={};function g(){}function m(){}function w(){}var b={};s(b,a,(function(){return this}));var x=Object.getPrototypeOf,S=x&&x(x(C([])));S&&S!==n&&r.call(S,a)&&(b=S);var _=w.prototype=g.prototype=Object.create(b);function L(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function n(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==et(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return n("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function k(e,n,r){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var u=O(c,r);if(u){if(u===v)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===h)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var s=f(e,n,r);if("normal"===s.type){if(o=r.done?y:p,s.arg===v)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(o=y,r.method="throw",r.arg=s.arg)}}}function O(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var i=f(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function N(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function C(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(et(e)+" is not iterable")}return m.prototype=w,o(_,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:m,configurable:!0}),m.displayName=s(w,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,u,"GeneratorFunction")),t.prototype=Object.create(_),t},e.awrap=function(t){return{__await:t}},L(E.prototype),s(E.prototype,c,(function(){return this})),e.AsyncIterator=E,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new E(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(_),s(_,u,"Generator"),s(_,a,(function(){return this})),s(_,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=C,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(N),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),s=r.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),N(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;N(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:C(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}function ut(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}var st={1:"levelEasy",2:"levelNormal",3:"levelHard"},lt={1:"【E】",2:"【N】",3:"【H】"};function ft(t){return ht.apply(this,arguments)}function ht(){var t;return t=ct().mark((function t(e){var n,r;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(n=e.flatMap((function(t){return t.playStatuses.map((function(t){var e=t.difficulty,n=t.track.id,r=t.track[st[t.difficulty]];return t.bestScore>95e4?{rate:(t.bestScore-95e4)/1e4+2.5+r,id:n,difficulty:e,title:t.track.title}:{rate:(t.bestScore-9e5)/2e4+r,id:n,difficulty:e,title:t.track.title}}))}));n.length<20;)n.push({rate:0});r=n.toSorted((function(t,e){return e.rate-t.rate})),$t((function(){return vt(r)}));case 4:case"end":return t.stop()}}),t)})),ht=function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){ut(i,r,o,a,c,"next",t)}function c(t){ut(i,r,o,a,c,"throw",t)}a(void 0)}))},ht.apply(this,arguments)}function pt(t){var e,n,r,o=t.v;if(o.id)return[(n=nt(),r=n.firstChild,K(r,(function(){return o.title+lt[o.difficulty]})),x((function(){return z(r,"href","https://beta.sparebeat.com/play/".concat(o.id))})),n),(e=rt(),K(e,(function(){return o.rate.toFixed(4)})),e)]}function dt(t){var e,n,r,o,i,a=t.rates,c=function(t){t.stopPropagation(),document.body.classList.add("sparebeat_extensions_rate_view_open")},u=function(t){t.stopPropagation(),document.body.classList.remove("sparebeat_extensions_rate_view_open")},s=a.slice(0,20).filter((function(t){return null!=t.id})).map((function(t){return U(pt,{v:t})})),l=a.slice(20,30).filter((function(t){return null!=t})).map((function(t){return U(pt,{v:t})}));return[(i=ot(),J(i,"click",c),i),(e=it(),n=e.firstChild,r=n.firstChild.nextSibling,o=r.nextSibling.nextSibling,J(e,"click",u),J(n,"click",(function(t){return t.stopPropagation()})),K(r,s),K(o,l),e)]}function yt(t){var e=t.rate,n=function(t){t.stopPropagation(),document.body.classList.add("sparebeat_extensions_rate_view_open")};return function(){var t=at();t.firstChild;return J(t,"click",n),K(t,(function(){return e.toFixed(2)}),null),t}()}function vt(t){var e,n,r=document.getElementsByClassName("music-list-header")[0];if(null!=t[0].id){if(!r||null==document.getElementById(t[0].id))throw new Error;null===(e=document.getElementsByClassName("sparebeat_extensions_rate")[0])||void 0===e||e.remove(),null===(n=document.getElementsByClassName("sparebeat_extensions_rate_button")[0])||void 0===n||n.remove();var o=t.slice(0,20).reduce((function(t,e){return t+e.rate}),0)/20;r.style.display="flex",r.style.justifyContent="space-between",Y((function(){return U(yt,{rate:o})}),r);var i=document.createElement("div");i.classList.add("sparebeat_extensions_rate_button"),document.querySelector(".main>ul").after(i),Y((function(){return U(dt,{rates:t})}),i)}}function gt(t){return gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gt(t)}function mt(t){return function(t){if(Array.isArray(t))return wt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return wt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wt(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function bt(){bt=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),c=new A(r||[]);return o(a,"_invoke",{value:k(t,n,c)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",v={};function g(){}function m(){}function w(){}var b={};s(b,a,(function(){return this}));var x=Object.getPrototypeOf,S=x&&x(x(C([])));S&&S!==n&&r.call(S,a)&&(b=S);var _=w.prototype=g.prototype=Object.create(b);function L(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function n(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==gt(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return n("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function k(e,n,r){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var u=O(c,r);if(u){if(u===v)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===h)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var s=f(e,n,r);if("normal"===s.type){if(o=r.done?y:p,s.arg===v)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(o=y,r.method="throw",r.arg=s.arg)}}}function O(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var i=f(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function N(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function C(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(gt(e)+" is not iterable")}return m.prototype=w,o(_,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:m,configurable:!0}),m.displayName=s(w,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,u,"GeneratorFunction")),t.prototype=Object.create(_),t},e.awrap=function(t){return{__await:t}},L(E.prototype),s(E.prototype,c,(function(){return this})),e.AsyncIterator=E,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new E(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(_),s(_,u,"Generator"),s(_,a,(function(){return this})),s(_,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=C,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(N),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),s=r.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),N(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;N(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:C(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}function xt(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function St(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){xt(i,r,o,a,c,"next",t)}function c(t){xt(i,r,o,a,c,"throw",t)}a(void 0)}))}}var _t=function(t){var e=t.track,n=e.title,r=e.id,o=e.levelEasy,i=e.levelNormal,a=e.levelHard,c=t.playStatuses,u={title:n,id:r,level:[o,i,a],isComplete:[!1,!1,!1],score:[null,null,null]};return c.map((function(t){var e=t.difficulty,n=t.isComplete,r=t.bestScore;u.isComplete[e-1]=n,u.score[e-1]=r})),u};function Lt(){return Lt=St(bt().mark((function t(){var e,n,r,o,i,a,c;return bt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e={name:"",displayname:"",home_data:[],recently_data:[]},t.next=4,fetch("/api/account").then((function(t){return t.ok&&t.json()}));case 4:if(n=t.sent){t.next=7;break}return t.abrupt("return",window.alert("アカウントにログインしてからやってね"));case 7:return e.name=n.user.name,e.displayname=n.user.displayName,t.next=11,fetch("/api/tracks/home").then(function(){var t=St(bt().mark((function t(n){var r;return bt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.json();case 2:r=t.sent,e.home_data=r.tracks.map(_t);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 11:r=1;case 12:return t.next=15,fetch("/api/tracks/recently?page=".concat(r));case 15:return i=t.sent,t.next=18,i.json();case 18:if(0!==(a=t.sent).tracks.length){t.next=21;break}return t.abrupt("break",26);case 21:c=a.tracks.map(_t),(o=e.recently_data).push.apply(o,mt(c)),r++,t.next=12;break;case 26:return t.abrupt("return",e);case 29:t.prev=29,t.t0=t.catch(0),console.error(t.t0),window.alert("エラー");case 33:case"end":return t.stop()}}),t,null,[[0,29]])}))),Lt.apply(this,arguments)}function Et(t){return Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Et(t)}function kt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Ot(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ot(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}function Ot(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function jt(){jt=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),c=new A(r||[]);return o(a,"_invoke",{value:k(t,n,c)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",v={};function g(){}function m(){}function w(){}var b={};s(b,a,(function(){return this}));var x=Object.getPrototypeOf,S=x&&x(x(C([])));S&&S!==n&&r.call(S,a)&&(b=S);var _=w.prototype=g.prototype=Object.create(b);function L(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function n(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==Et(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return n("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function k(e,n,r){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var u=O(c,r);if(u){if(u===v)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===h)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var s=f(e,n,r);if("normal"===s.type){if(o=r.done?y:p,s.arg===v)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(o=y,r.method="throw",r.arg=s.arg)}}}function O(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var i=f(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function N(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function C(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(Et(e)+" is not iterable")}return m.prototype=w,o(_,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:m,configurable:!0}),m.displayName=s(w,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,u,"GeneratorFunction")),t.prototype=Object.create(_),t},e.awrap=function(t){return{__await:t}},L(E.prototype),s(E.prototype,c,(function(){return this})),e.AsyncIterator=E,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new E(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(_),s(_,u,"Generator"),s(_,a,(function(){return this})),s(_,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=C,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(N),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),s=r.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),N(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;N(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:C(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}function Nt(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function At(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Nt(i,r,o,a,c,"next",t)}function c(t){Nt(i,r,o,a,c,"throw",t)}a(void 0)}))}}var Ct=function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null===(e=document.getElementsByClassName(t)[n])||void 0===e||null===(e=e.innerHTML)||void 0===e?void 0:e.replace(/\s/g,"")},Tt=function(t){if(t){var e=t.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/);return e&&5===e.length?"".concat("0".concat(Number.parseInt(e[1]).toString(16)).slice(-2)).concat("0".concat(Number.parseInt(e[2]).toString(16)).slice(-2)).concat("0".concat(Number.parseInt(e[3]).toString(16)).slice(-2)).concat("0".concat((255*Number.parseFloat(e[4])).toString(16)).slice(-2)):""}};function Pt(){return(Pt=At(jt().mark((function t(){return jt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("/api/tracks/home").then((function(t){return t.json()})).then((function(t){$t((function(){return Ft(t.tracks)})),ft(t.tracks)}));case 3:return t.next=5,fetch("/api/tracks/recently?page=1").then((function(t){return t.json()})).then((function(t){$t((function(){return Ft(t.tracks)}))}));case 5:t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:case"end":return t.stop()}}),t,null,[[0,7]])})))).apply(this,arguments)}function It(){return(It=At(jt().mark((function t(){var e,n;return jt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=null!==(e=new URLSearchParams(location.search).get("page"))&&void 0!==e?e:"1",t.next=4,fetch("/api/tracks/recently?page=".concat(n)).then((function(t){return t.json()})).then((function(t){$t((function(){return Ft(t.tracks)}))}));case 4:t.next=8;break;case 6:t.prev=6,t.t0=t.catch(0);case 8:case"end":return t.stop()}}),t,null,[[0,6]])})))).apply(this,arguments)}chrome.runtime.onMessage.addListener((function(t,e,n){switch(t.message){case"screenshot":var r=(v="rerere",document.getElementById(v));if(r){var o,i,a,c=document.getElementsByClassName("Track_title")[0].innerHTML,u=document.getElementsByClassName("Track_artist")[0].innerHTML,s=Ct("Track_difficulty"),l=Ct("Score_value"),f=Ct("Rank_value"),h="Sparebeatの「".concat(c,"/").concat(u,"」(").concat(s,") で").concat(l,"点(ランク").concat(f,")を獲得しました！"),p=(Ct("Track_layout")?"&".concat(Ct("Track_layout"),"="):"")+(Ct("Track_bind")?"&".concat(Ct("Track_bind"),"="):"");if(!r)throw new Error;var d=r.style.backgroundImage,y="?title=".concat(encodeURIComponent(c),"&artist=").concat(encodeURIComponent(u),"&difficult=").concat(s.toLowerCase()).concat(p.toLowerCase(),"&score=").concat(l,"&diff=").concat(null!==(o=Ct("Score_diff"))&&void 0!==o?o:"none".replace(/[\[\]]/g,""),"&rank=").concat(Ct("Rank_value"),"&just=").concat(Ct("Detail_table_row_value",0),"&rush=").concat(Ct("Detail_table_row_value",1),"&cool=").concat(Ct("Detail_table_row_value",2),"&miss=").concat(Ct("Detail_table_row_value",3),"&average=").concat(Ct("Average_value").replace(/ms/g,""),"&chain=").concat(Ct("Detail_table_row_value",4),"&attack=").concat(Ct("Detail_table_row_value",5).replace(/%/g,""),"&backcolor1=").concat(Tt(null===(i=d.match(/rgba\((.*?)\)/g))||void 0===i?void 0:i[0]),"&backcolor2=").concat(Tt(null===(a=d.match(/rgba\((.*?)\)/g))||void 0===a?void 0:a[1]),"&src=").concat(t.src);n({message:h,url:"https://sparebeatter.vercel.app/result"+y,img:undefined})}else n({message:"noresult"});return!0;case"toppage":return function(){return Pt.apply(this,arguments)}().then(n),!0;case"creators":return function(){return It.apply(this,arguments)}().then(n),!0;case"scorecheck":return function(){return Lt.apply(this,arguments)}().then((function(t){return n(t)})),!0}var v}));var Gt=function(t,e){return e.difficulty-t.difficulty};function Ft(t){return Bt.apply(this,arguments)}function Bt(){return(Bt=At(jt().mark((function t(e){var n,r,o,i,a;return jt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=kt(e),t.prev=1,n.s();case 3:if((r=n.n()).done){t.next=12;break}if(i=r.value,null===(o=i.playStatuses.sort(Gt)[0])||void 0===o||!o.isComplete){t.next=10;break}if(a=document.getElementById(i.track.id)){t.next=9;break}throw new Error;case 9:a.getElementsByClassName("music-list-item-score")[0].classList.add("sparebeat_extensions_fullchain");case 10:t.next=3;break;case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(1),n.e(t.t0);case 17:return t.prev=17,n.f(),t.finish(17);case 20:case"end":return t.stop()}}),t,null,[[1,14,17,20]])})))).apply(this,arguments)}function $t(t){return Mt.apply(this,arguments)}function Mt(){return(Mt=At(jt().mark((function t(e){return jt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e();case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),setTimeout((function(){return $t(e)}),100);case 8:case"end":return t.stop()}}),t,null,[[0,5]])})))).apply(this,arguments)}})();